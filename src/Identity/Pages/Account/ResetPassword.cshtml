@page
@model Engrslan.Pages.Account.ResetPassword
@{
    ViewData["Title"] = "Reset Password";
}

<div class="container-fluid h-100 d-flex align-items-center justify-content-center">
    <div class="card shadow-lg border-0 rounded-4 p-4" style="max-width: 420px; width: 100%;">
        <div class="card-body">
            <div class="text-center mb-4">
                <div class="d-inline-flex align-items-center justify-content-center rounded-circle text-white mb-3" 
                     style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <i class="bi bi-shield-lock-fill" style="font-size: 2rem;"></i>
                </div>
                <h1 class="h3 fw-bold text-dark">Reset Password</h1>
                <p class="text-muted">Enter your new password below.</p>
            </div>

            <form method="post">
                <div asp-validation-summary="ModelOnly" class="alert alert-danger" role="alert"></div>
                <input asp-for="Input.Code" type="hidden" />
                
                <div class="mb-3">
                    <label asp-for="Input.Email" class="form-label">Email Address</label>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0">
                            <i class="bi bi-envelope"></i>
                        </span>
                        <input asp-for="Input.Email" class="form-control border-start-0" readonly />
                    </div>
                    <span asp-validation-for="Input.Email" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="Input.Password" class="form-label">New Password</label>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0">
                            <i class="bi bi-lock"></i>
                        </span>
                        <input asp-for="Input.Password" class="form-control border-start-0 border-end-0" 
                               type="password" id="newPassword" />
                        <button class="btn btn-outline-secondary border-start-0" type="button" 
                                onclick="togglePassword('newPassword')">
                            <i class="bi bi-eye" id="newPasswordIcon"></i>
                        </button>
                    </div>
                    <span asp-validation-for="Input.Password" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="Input.ConfirmPassword" class="form-label">Confirm New Password</label>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0">
                            <i class="bi bi-lock-fill"></i>
                        </span>
                        <input asp-for="Input.ConfirmPassword" class="form-control border-start-0 border-end-0" 
                               type="password" id="confirmPassword" />
                        <button class="btn btn-outline-secondary border-start-0" type="button" 
                                onclick="togglePassword('confirmPassword')">
                            <i class="bi bi-eye" id="confirmPasswordIcon"></i>
                        </button>
                    </div>
                    <span asp-validation-for="Input.ConfirmPassword" class="text-danger small"></span>
                </div>

                <div class="card bg-light mb-3">
                    <div class="card-body py-2">
                        <small class="text-muted">Password Requirements:</small>
                        <ul class="mb-0 small text-muted">
                            <li id="length-check"><i class="bi bi-x-circle text-danger"></i> At least 6 characters</li>
                            <li id="uppercase-check"><i class="bi bi-x-circle text-danger"></i> One uppercase letter</li>
                            <li id="lowercase-check"><i class="bi bi-x-circle text-danger"></i> One lowercase letter</li>
                            <li id="number-check"><i class="bi bi-x-circle text-danger"></i> One number</li>
                        </ul>
                    </div>
                </div>

                <div class="d-grid gap-2">
                    <button type="submit" class="btn btn-primary rounded-3">
                        <i class="bi bi-check-circle me-2"></i>Reset Password
                    </button>
                </div>
            </form>

            <hr class="my-4">

            <div class="text-center">
                <p class="mb-0">
                    <a asp-page="./Login" class="text-decoration-none">
                        <i class="bi bi-arrow-left me-1"></i>Back to Sign In
                    </a>
                </p>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.98);
        }
        
        .input-group-text {
            background-color: #f8f9fa !important;
            border-color: #dee2e6 !important;
        }
        
        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            padding: 0.75rem;
            font-weight: 500;
            transition: transform 0.2s;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        a {
            color: #667eea;
            font-weight: 500;
        }
        
        a:hover {
            color: #764ba2;
        }
    </style>
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        function togglePassword(fieldId) {
            var field = document.getElementById(fieldId);
            var icon = document.getElementById(fieldId + 'Icon');
            
            if (field.type === "password") {
                field.type = "text";
                icon.classList.remove('bi-eye');
                icon.classList.add('bi-eye-slash');
            } else {
                field.type = "password";
                icon.classList.remove('bi-eye-slash');
                icon.classList.add('bi-eye');
            }
        }

        // Password strength checker
        document.getElementById('newPassword').addEventListener('input', function(e) {
            var password = e.target.value;
            
            updateRequirement('length-check', password.length >= 6);
            updateRequirement('uppercase-check', /[A-Z]/.test(password));
            updateRequirement('lowercase-check', /[a-z]/.test(password));
            updateRequirement('number-check', /\d/.test(password));
        });

        function updateRequirement(elementId, isMet) {
            var element = document.getElementById(elementId);
            var icon = element.querySelector('i');
            
            if (isMet) {
                icon.classList.remove('bi-x-circle', 'text-danger');
                icon.classList.add('bi-check-circle', 'text-success');
            } else {
                icon.classList.remove('bi-check-circle', 'text-success');
                icon.classList.add('bi-x-circle', 'text-danger');
            }
        }
    </script>
}